# –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –∑ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

## –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ç–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è

### ‚úÖ –ö–æ–¥ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ç–∞ –Ω–∞–¥–∞—î –±–∞–∂–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
### ‚úÖ –°–∫—Ä–∏–Ω—à–æ—Ç–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–±–æ—Ç–∏
### ‚úÖ –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –ø–æ–∑–Ω–∞—á–∞—é—Ç—å –∫–æ–∂–µ–Ω –µ—Ç–∞–ø –∑–∞–≤–¥–∞–Ω–Ω—è

---

## –ß–∞—Å—Ç–∏–Ω–∞ 1: Streaming Pipeline

### –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

1. **–ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ pipeline:**
```bash
python main.py
```

2. **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:**
```bash
python demo_results.py
```

### –©–æ –ø–æ–∫–∞–∑–∞—Ç–∏ –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö:

#### üéØ **–û–±–æ–≤'—è–∑–∫–æ–≤—ñ —Å–∫—Ä–∏–Ω—à–æ—Ç–∏:**

1. **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö MySQL - —Ç–∞–±–ª–∏—Ü—è `enriched_athlete_stats`:**
   - –ó–∞–ø–∏—Ç: `SELECT * FROM enriched_athlete_stats LIMIT 20;`
   - –ü–æ–∫–∞–∑—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –∑ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏

2. **Kafka —Ç–æ–ø—ñ–∫ - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ `enriched_athlete_data`:**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ `demo_results.py` –¥–ª—è –ø–æ–∫–∞–∑—É –¥–∞–Ω–∏—Ö –∑ Kafka
   - –ê–±–æ Kafka console consumer –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

#### üìã **–ï—Ç–∞–ø–∏ –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ –≤ –∫–æ–¥—ñ:**

```python
# –ï—Ç–∞–ø 1: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ñ—ñ–∑–∏—á–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –∞—Ç–ª–µ—Ç—ñ–≤ –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ
# –ï—Ç–∞–ø 2: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö (–≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—ñ—Ö —Ç–∞ –Ω–µ—á–∏—Å–ª–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å)
# –ï—Ç–∞–ø 3.1: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ athlete_event_results –¥–ª—è –∑–∞–ø–∏—Å—É –≤ Kafka
# –ï—Ç–∞–ø 3.2: –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö –∑ MySQL –≤ Kafka-—Ç–æ–ø—ñ–∫ athlete_event_results
# –ï—Ç–∞–ø 3.3: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è streaming –¥–∞–Ω–∏—Ö –∑ Kafka-—Ç–æ–ø—ñ–∫—É
# –ï—Ç–∞–ø 4: –û–±'—î–¥–Ω–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ –∫–ª—é—á–µ–º athlete_id
# –ï—Ç–∞–ø 5: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Å–µ—Ä–µ–¥–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å
# –ï—Ç–∞–ø 6.–∞): –ó–∞–ø–∏—Å —É –≤–∏—Ö—ñ–¥–Ω–∏–π Kafka-—Ç–æ–ø—ñ–∫
# –ï—Ç–∞–ø 6.b): –ó–∞–ø–∏—Å —É –±–∞–∑—É –¥–∞–Ω–∏—Ö MySQL
```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 2: Batch Data Lake

### –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

1. **–õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**
```bash
python batch_processing/test_pipeline_locally.py
```

2. **–û–∫—Ä–µ–º—ñ –µ—Ç–∞–ø–∏:**
```bash
python batch_processing/landing_to_bronze.py
python batch_processing/bronze_to_silver.py
python batch_processing/silver_to_gold.py
```

### –©–æ –ø–æ–∫–∞–∑–∞—Ç–∏ –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö:

#### üéØ **–û–±–æ–≤'—è–∑–∫–æ–≤—ñ —Å–∫—Ä–∏–Ω—à–æ—Ç–∏:**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:**
```
data/
‚îú‚îÄ‚îÄ landing/
‚îÇ   ‚îú‚îÄ‚îÄ athlete_bio.csv
‚îÇ   ‚îî‚îÄ‚îÄ athlete_event_results.csv
‚îú‚îÄ‚îÄ bronze/
‚îÇ   ‚îú‚îÄ‚îÄ athlete_bio/ (parquet files)
‚îÇ   ‚îî‚îÄ‚îÄ athlete_event_results/ (parquet files)
‚îú‚îÄ‚îÄ silver/
‚îÇ   ‚îú‚îÄ‚îÄ athlete_bio/ (cleaned parquet files)
‚îÇ   ‚îî‚îÄ‚îÄ athlete_event_results/ (cleaned parquet files)
‚îî‚îÄ‚îÄ gold/
    ‚îî‚îÄ‚îÄ avg_stats/ (aggregated parquet files)
```

2. **–í–º—ñ—Å—Ç gold layer - avg_stats:**
   - –ü–æ–∫–∞–∑–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –∑ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
   - –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –ø–æ sport, medal, sex, country_noc

#### üìã **–ï—Ç–∞–ø–∏ –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ –≤ –∫–æ–¥—ñ:**

```python
# landing_to_bronze.py:
# –ï—Ç–∞–ø 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑ FTP-—Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ CSV
# –ï—Ç–∞–ø 2: –ß–∏—Ç–∞–Ω–Ω—è CSV —Ñ–∞–π–ª—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É —Ñ–æ—Ä–º–∞—Ç—ñ Parquet

# bronze_to_silver.py:
# –ï—Ç–∞–ø 1: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∑ bronze layer
# –ï—Ç–∞–ø 2: –í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó —á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç—É –¥–ª—è –≤—Å—ñ—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫
# –ï—Ç–∞–ø 3: –î–µ–¥—É–±–ª—ñ–∫–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤

# silver_to_gold.py:
# –ï—Ç–∞–ø 1: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –¥–≤–æ—Ö —Ç–∞–±–ª–∏—Ü—å —ñ–∑ silver layer
# –ï—Ç–∞–ø 2: –í–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –¥–µ—è–∫–∏—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å
# –ï—Ç–∞–ø 3: –ó–∞–ø–∏—Å —Ç–∞–±–ª–∏—Ü—ñ –≤ –ø–∞–ø–∫—É gold

# project_solution.py:
# Airflow DAG —è–∫–∏–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞—î –≤—Å—ñ —Ç—Ä–∏ —Ñ–∞–π–ª–∏
```

---

## –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### MySQL –∑–∞–ø–∏—Ç–∏:
```sql
-- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Å—ñ–≤
SELECT COUNT(*) FROM enriched_athlete_stats;

-- –ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö
SELECT sport, medal_status, sex, country_noc, avg_height, avg_weight, timestamp 
FROM enriched_athlete_stats 
LIMIT 10;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–ø–æ—Ä—Ç–∞–º
SELECT sport, COUNT(*) as count 
FROM enriched_athlete_stats 
GROUP BY sport 
ORDER BY count DESC;
```

### Kafka –∫–æ–º–∞–Ω–¥–∏:
```bash
# –ü–µ—Ä–µ–≥–ª—è–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ —Ç–æ–ø—ñ–∫—É
kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic enriched_athlete_data --from-beginning

# –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ demo_results.py –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É
```

### Spark –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ Parquet —Ñ–∞–π–ª—ñ–≤:
```python
# –ß–∏—Ç–∞–Ω–Ω—è gold layer —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
df = spark.read.parquet("data/gold/avg_stats")
df.show(20, truncate=False)
df.printSchema()
print(f"Total records: {df.count()}")
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∑–¥–∞—á—ñ –ø—Ä–æ—î–∫—Ç—É

### –ß–∞—Å—Ç–∏–Ω–∞ 1 (Streaming):
- [ ] –ö–æ–¥ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- [ ] –°–∫—Ä–∏–Ω—à–æ—Ç —Ç–∞–±–ª–∏—Ü—ñ MySQL –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- [ ] –°–∫—Ä–∏–Ω—à–æ—Ç –¥–∞–Ω–∏—Ö –∑ Kafka —Ç–æ–ø—ñ–∫—É
- [ ] –í—Å—ñ –µ—Ç–∞–ø–∏ –ø–æ–∑–Ω–∞—á–µ–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏
- [ ] forEachBatch —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–∞—Ü—é—î

### –ß–∞—Å—Ç–∏–Ω–∞ 2 (Batch):
- [ ] –í—Å—ñ —Ç—Ä–∏ —Ñ–∞–π–ª–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ data lake —Å—Ç–≤–æ—Ä–µ–Ω–∞
- [ ] –°–∫—Ä–∏–Ω—à–æ—Ç gold layer —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- [ ] Airflow DAG —Å—Ç–≤–æ—Ä–µ–Ω–∏–π
- [ ] –í—Å—ñ –µ—Ç–∞–ø–∏ –ø–æ–∑–Ω–∞—á–µ–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏

### –ó–∞–≥–∞–ª—å–Ω–µ:
- [ ] README.md –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏
- [ ] –ö–æ–¥ –¥–æ–±—Ä–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π
- [ ] –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞
- [ ] –õ–æ–≥—É–≤–∞–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–µ —Ç–∞ –∑—Ä–æ–∑—É–º—ñ–ª–µ